{"pageProps":{"post":{"title":"Typescript è¾¨åˆ«è”åˆç±»å‹","date":1617321600,"slug":"typescript-union","author":"kaichi","content":"<p>åœ¨ä½¿ç”¨è”åˆç±»å‹æ—¶ï¼Œé€šå¸¸éœ€è¦åˆ¤æ–­è”åˆç±»å‹çš„å…·ä½“ç±»å‹ï¼Œè€ƒè™‘å¦‚ä¸‹ ğŸŒ°</p>\n<pre><code class=\"language-ts\">interface Square {\n  kind: \"square\";\n  size: number;\n}\n\ninterface Rectangle {\n  kind: \"rectangle\";\n  width: number;\n  height: number;\n}\n\ntype Shape = Square | Rectangle;\n</code></pre>\n<p><code>Square</code> å’Œ <code>Rectangle</code> æœ‰å…±åŒå­—é¢é‡æˆå‘˜ <code>kind</code>ï¼Œä¸€èˆ¬è”åˆç±»å‹çš„æˆå‘˜æœ‰ä¸€äº›è‡ªå·±çš„è¡Œä¸ºï¼Œæ­¤æ—¶å¯ä»¥æ ¹æ® <code>kind</code> å±æ€§æ¥åˆ¤æ–­è”åˆç±»å‹ï¼Œä¾‹å¦‚ä¸‹é¢è®¡ç®—é¢ç§¯çš„ functionã€‚</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  if (s.kind === \"square\") {\n    // ç°åœ¨ TypeScript çŸ¥é“ s çš„ç±»å‹æ˜¯ Square\n    // æ‰€ä»¥ä½ ç°åœ¨èƒ½å®‰å…¨ä½¿ç”¨å®ƒ\n    return s.size * s.size;\n  } else {\n    // ä¸æ˜¯ä¸€ä¸ª square ï¼Ÿå› æ­¤ TypeScript å°†ä¼šæ¨ç®—å‡º s ä¸€å®šæ˜¯ Rectangle\n    return s.width * s.height;\n  }\n}\n</code></pre>\n<p>ä¸€åˆ‡éƒ½å¾ˆå®Œç¾ï¼Œå¦‚æœæ­¤æ—¶ <code>Shape</code> ç±»å‹å¢åŠ äº†ä¸€ç§ç±»å‹ã€‚</p>\n<pre><code class=\"language-ts\">interface Circle {\n  kind: \"circle\";\n  radius: number;\n}\n\ntype Shape = Square | Rectangle | Circle;\n</code></pre>\n<p>è¿™æ—¶è®¡ç®—é¢ç§¯çš„ Function ç¼ºå°‘å¯¹ <code>Circle</code> ç±»å‹çš„å¤„ç†é€»è¾‘ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°å®ƒå¹¶ä¸ä¼šç»™ä½ æŠ›å‡ºä»»ä½•é”™è¯¯ï¼Œè¿™æ˜¯å¾ˆç³Ÿç³•çš„ã€‚</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  if (s.kind === \"square\") {\n    return s.size * s.size;\n  } else if (s.kind === \"rectangle\") {\n    return s.width * s.height;\n  }\n\n  // å¦‚æœä½ èƒ½è®© TypeScript ç»™ä½ ä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼Ÿ\n}\n</code></pre>\n<p>ä½ å¯ä»¥é€šè¿‡ç¡®ä¿å—ä¸­çš„ç±»å‹è¢«æ¨æ–­ä¸ºä¸ <code>never</code> ç±»å‹å…¼å®¹çš„ç±»å‹ï¼Œä»¥æ­¤æ¥æ•è·é”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  if (s.kind === \"square\") {\n    return s.size * s.size;\n  } else if (s.kind === \"rectangle\") {\n    return s.width * s.height;\n  } else {\n    // æ­¤æ—¶ç±»å‹è¢«åˆ¤æ–­ä¸º `Circle`\n    // Error: 'Circle' ä¸èƒ½è¢«èµ‹å€¼ç»™ 'never'\n    const _exhaustiveCheck: never = s;\n  }\n}\n</code></pre>\n<p>å®ƒå°†å¼ºåˆ¶ä½ æ·»åŠ ä¸€ç§æ–°çš„æ¡ä»¶ã€‚</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  if (s.kind === \"square\") {\n    return s.size * s.size;\n  } else if (s.kind === \"rectangle\") {\n    return s.width * s.height;\n  } else if (s.kind === \"circle\") {\n    return Math.PI * s.radius ** 2;\n  } else {\n    // æ­¤æ—¶ç±»å‹æ”¶ç¼©ä¸º `never`\n    const _exhaustiveCheck: never = s;\n  }\n}\n</code></pre>\n<p>ä½ å¯ä»¥é€šè¿‡ <code>switch</code> å®ç°ä»¥ä¸Šä¾‹å­ã€‚</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  switch (s.kind) {\n    case \"square\":\n      return s.size * s.size;\n    case \"rectangle\":\n      return s.width * s.height;\n    case \"circle\":\n      return Math.PI * s.radius ** 2;\n    default:\n      // æ­¤æ—¶ç±»å‹æ”¶ç¼©ä¸º `never`\n      const _exhaustiveCheck: never = s;\n  }\n}\n</code></pre>\n<p>å¦‚æœä½ ä½¿ç”¨ <code>strictNullChecks</code> é€‰é¡¹æ¥åšè¯¦ç»†çš„æ£€æŸ¥ï¼Œä½ åº”è¯¥è¿”å› <code>_exhaustiveCheck</code> å˜é‡ï¼ˆç±»å‹æ˜¯ <code>never</code>ï¼‰ï¼Œå¦åˆ™ TypeScript å¯èƒ½ä¼šæ¨æ–­è¿”å›å€¼ä¸º <code>undefined</code>ã€‚</p>\n<pre><code class=\"language-ts\">function area(s: Shape) {\n  switch (s.kind) {\n    case \"square\":\n      return s.size * s.size;\n    case \"rectangle\":\n      return s.width * s.height;\n    case \"circle\":\n      return Math.PI * s.radius ** 2;\n    default:\n      const _exhaustiveCheck: never = s;\n      return _exhaustiveCheck;\n  }\n}\n</code></pre>\n","excerpt":"Tempor sunt tempor voluptate nulla labore nostrud deserunt pariatur commodo elit laborum nisi aliquip."}},"__N_SSG":true}